{"ast":null,"code":"var _jsxFileName = \"/app/src/pages/progression.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { Doughnut } from 'react-chartjs-2';\nimport axios from 'axios';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\nimport ChartDataLabels from 'chartjs-plugin-datalabels';\nimport '../styles/progression.css';\nimport 'foot';\nimport Header from '../components/header';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(ArcElement, Tooltip, Legend, ChartDataLabels);\nconst ProgressionChart = () => {\n  _s();\n  const [chartData, setChartData] = useState({});\n\n  // Liste de toutes les matières possibles, mémorisée pour éviter les changements de dépendances\n  const allSubjects = useMemo(() => ['Mathématiques', 'Français', 'Histoire', 'Géographie', 'Sciences', 'Anglais'], []);\n  useEffect(() => {\n    let isMounted = true; // Drapeau pour vérifier si le composant est monté\n\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const response = await axios.get('http://localhost:5000/dashboard/student', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log('Data:', response.data);\n\n        // Initialiser les données pour chaque matière\n        const subjectsData = {};\n        allSubjects.forEach(subject => {\n          subjectsData[subject] = {\n            goodAnswers: 0,\n            badAnswers: 0\n          };\n        });\n\n        // Mettre à jour les données avec les valeurs récupérées\n        Object.entries(response.data).forEach(([subject, result]) => {\n          const score = parseInt(result.totalScore, 10);\n          const totalQuestions = parseInt(result.questionCount, 10);\n          if (subjectsData[subject]) {\n            subjectsData[subject].goodAnswers = score;\n            subjectsData[subject].badAnswers = totalQuestions - score;\n          }\n        });\n\n        // Créer les données pour chaque graphique\n        const charts = {};\n        Object.keys(subjectsData).forEach(subject => {\n          const goodAnswers = subjectsData[subject].goodAnswers;\n          const badAnswers = subjectsData[subject].badAnswers;\n          charts[subject] = {\n            labels: ['Bonnes Réponses', 'Mauvaises Réponses'],\n            datasets: [{\n              label: subject,\n              data: [goodAnswers, badAnswers],\n              backgroundColor: ['rgba(75, 192, 192, 0.6)',\n              // Couleur pour les bonnes réponses\n              'rgba(255, 99, 132, 0.6)' // Couleur pour les mauvaises réponses\n              ],\n              borderWidth: 1\n            }],\n            plugins: {\n              datalabels: {\n                display: context => context.dataIndex === 0,\n                // Afficher uniquement pour les bonnes réponses\n                formatter: (value, context) => {\n                  const total = context.dataset.data.reduce((acc, val) => acc + val, 0);\n                  const percentage = total > 0 ? (context.dataset.data[0] / total * 100).toFixed(0) : null;\n                  return percentage !== null ? `${percentage}%` : 'pas de données';\n                },\n                color: 'black',\n                font: {\n                  weight: 'bold',\n                  size: 16\n                }\n              }\n            }\n          };\n        });\n        if (isMounted) {\n          setChartData(charts);\n        }\n      } catch (error) {\n        if (isMounted) {\n          console.error('Error fetching data:', error);\n        }\n      }\n    };\n    fetchData();\n    return () => {\n      isMounted = false; // Mettre à jour le drapeau lorsque le composant est démonté\n    };\n  }, [allSubjects]); // Ajoutez allSubjects comme dépendance\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Voici ta progression :\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-grid\",\n      children: Object.keys(chartData).map(subject => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: subject\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Doughnut, {\n          data: chartData[subject],\n          options: {\n            responsive: true,\n            plugins: {\n              legend: {\n                position: 'top'\n              },\n              title: {\n                display: true,\n                text: `Progression en ${subject}`\n              },\n              datalabels: {\n                display: context => context.dataIndex === 0,\n                // Afficher uniquement pour les bonnes réponses\n                formatter: (value, context) => {\n                  const total = context.dataset.data.reduce((acc, val) => acc + val, 0);\n                  const percentage = total > 0 ? (context.dataset.data[0] / total * 100).toFixed(0) : null;\n                  return percentage !== null ? `${percentage}%` : 'pas de données';\n                },\n                color: 'black',\n                font: {\n                  weight: 'bold',\n                  size: 16\n                }\n              }\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this)]\n      }, subject, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 5\n  }, this);\n};\n_s(ProgressionChart, \"OmJYol6KVTQYEYD3JhJwDt5scnc=\");\n_c = ProgressionChart;\nexport default ProgressionChart;\nvar _c;\n$RefreshReg$(_c, \"ProgressionChart\");","map":{"version":3,"names":["React","useEffect","useState","useMemo","Doughnut","axios","Chart","ChartJS","ArcElement","Tooltip","Legend","ChartDataLabels","Header","jsxDEV","_jsxDEV","register","ProgressionChart","_s","chartData","setChartData","allSubjects","isMounted","fetchData","token","localStorage","getItem","response","get","headers","Authorization","console","log","data","subjectsData","forEach","subject","goodAnswers","badAnswers","Object","entries","result","score","parseInt","totalScore","totalQuestions","questionCount","charts","keys","labels","datasets","label","backgroundColor","borderWidth","plugins","datalabels","display","context","dataIndex","formatter","value","total","dataset","reduce","acc","val","percentage","toFixed","color","font","weight","size","error","children","fileName","_jsxFileName","lineNumber","columnNumber","className","map","options","responsive","legend","position","title","text","Footer","_c","$RefreshReg$"],"sources":["/app/src/pages/progression.js"],"sourcesContent":["import React, { useEffect, useState, useMemo } from 'react';\nimport { Doughnut } from 'react-chartjs-2';\nimport axios from 'axios';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\nimport ChartDataLabels from 'chartjs-plugin-datalabels';\nimport '../styles/progression.css';\nimport 'foot'\nimport Header from '../components/header';\n\nChartJS.register(ArcElement, Tooltip, Legend, ChartDataLabels);\n\nconst ProgressionChart = () => {\n  const [chartData, setChartData] = useState({});\n\n  // Liste de toutes les matières possibles, mémorisée pour éviter les changements de dépendances\n  const allSubjects = useMemo(() => ['Mathématiques', 'Français', 'Histoire', 'Géographie', 'Sciences', 'Anglais'], []);\n\n  useEffect(() => {\n    let isMounted = true; // Drapeau pour vérifier si le composant est monté\n\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const response = await axios.get('http://localhost:5000/dashboard/student', {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n\n        console.log('Data:', response.data);\n\n        // Initialiser les données pour chaque matière\n        const subjectsData = {};\n\n        allSubjects.forEach((subject) => {\n          subjectsData[subject] = {\n            goodAnswers: 0,\n            badAnswers: 0,\n          };\n        });\n\n        // Mettre à jour les données avec les valeurs récupérées\n        Object.entries(response.data).forEach(([subject, result]) => {\n          const score = parseInt(result.totalScore, 10);\n          const totalQuestions = parseInt(result.questionCount, 10);\n\n          if (subjectsData[subject]) {\n            subjectsData[subject].goodAnswers = score;\n            subjectsData[subject].badAnswers = totalQuestions - score;\n          }\n        });\n\n        // Créer les données pour chaque graphique\n        const charts = {};\n        Object.keys(subjectsData).forEach((subject) => {\n          const goodAnswers = subjectsData[subject].goodAnswers;\n          const badAnswers = subjectsData[subject].badAnswers;\n\n          charts[subject] = {\n            labels: ['Bonnes Réponses', 'Mauvaises Réponses'],\n            datasets: [\n              {\n                label: subject,\n                data: [goodAnswers, badAnswers],\n                backgroundColor: [\n                  'rgba(75, 192, 192, 0.6)', // Couleur pour les bonnes réponses\n                  'rgba(255, 99, 132, 0.6)',  // Couleur pour les mauvaises réponses\n                ],\n                borderWidth: 1,\n              },\n            ],\n            plugins: {\n              datalabels: {\n                display: (context) => context.dataIndex === 0, // Afficher uniquement pour les bonnes réponses\n                formatter: (value, context) => {\n                  const total = context.dataset.data.reduce((acc, val) => acc + val, 0);\n                  const percentage = total > 0 ? ((context.dataset.data[0] / total) * 100).toFixed(0) : null;\n                  return percentage !== null ? `${percentage}%` : 'pas de données';\n                },\n                color: 'black',\n                font: {\n                  weight: 'bold',\n                  size: 16,\n                },\n              },\n            },\n          };\n        });\n\n        if (isMounted) {\n          setChartData(charts);\n        }\n      } catch (error) {\n        if (isMounted) {\n          console.error('Error fetching data:', error);\n        }\n      }\n    };\n\n    fetchData();\n\n    return () => {\n      isMounted = false; // Mettre à jour le drapeau lorsque le composant est démonté\n    };\n  }, [allSubjects]); // Ajoutez allSubjects comme dépendance\n\n  return (\n    <div>\n      <Header/>\n      <h2>Voici ta progression :</h2>\n      <div className='chart-grid'>\n        {Object.keys(chartData).map((subject) => (\n          <div key={subject} className=\"chart-container\">\n            <h3>{subject}</h3>\n            <Doughnut\n              data={chartData[subject]}\n              options={{\n                responsive: true,\n                plugins: {\n                  legend: {\n                    position: 'top',\n                  },\n                  title: {\n                    display: true,\n                    text: `Progression en ${subject}`,\n                  },\n                  datalabels: {\n                    display: (context) => context.dataIndex === 0, // Afficher uniquement pour les bonnes réponses\n                    formatter: (value, context) => {\n                      const total = context.dataset.data.reduce((acc, val) => acc + val, 0);\n                      const percentage = total > 0 ? ((context.dataset.data[0] / total) * 100).toFixed(0) : null;\n                      return percentage !== null ? `${percentage}%` : 'pas de données';\n                    },\n                    color: 'black',\n                    font: {\n                      weight: 'bold',\n                      size: 16,\n                    },\n                  },\n                },\n              }}\n            />\n          </div>\n        ))}\n      </div>\n      <Footer />\n    </div>\n  );\n};\n\nexport default ProgressionChart;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,OAAO;AAC3D,SAASC,QAAQ,QAAQ,iBAAiB;AAC1C,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,IAAIC,OAAO,EAAEC,UAAU,EAAEC,OAAO,EAAEC,MAAM,QAAQ,UAAU;AACxE,OAAOC,eAAe,MAAM,2BAA2B;AACvD,OAAO,2BAA2B;AAClC,OAAO,MAAM;AACb,OAAOC,MAAM,MAAM,sBAAsB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1CP,OAAO,CAACQ,QAAQ,CAACP,UAAU,EAAEC,OAAO,EAAEC,MAAM,EAAEC,eAAe,CAAC;AAE9D,MAAMK,gBAAgB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC7B,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGjB,QAAQ,CAAC,CAAC,CAAC,CAAC;;EAE9C;EACA,MAAMkB,WAAW,GAAGjB,OAAO,CAAC,MAAM,CAAC,eAAe,EAAE,UAAU,EAAE,UAAU,EAAE,YAAY,EAAE,UAAU,EAAE,SAAS,CAAC,EAAE,EAAE,CAAC;EAErHF,SAAS,CAAC,MAAM;IACd,IAAIoB,SAAS,GAAG,IAAI,CAAC,CAAC;;IAEtB,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAC3C,MAAMC,QAAQ,GAAG,MAAMrB,KAAK,CAACsB,GAAG,CAAC,yCAAyC,EAAE;UAC1EC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUN,KAAK;UAAG;QAC9C,CAAC,CAAC;QAEFO,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEL,QAAQ,CAACM,IAAI,CAAC;;QAEnC;QACA,MAAMC,YAAY,GAAG,CAAC,CAAC;QAEvBb,WAAW,CAACc,OAAO,CAAEC,OAAO,IAAK;UAC/BF,YAAY,CAACE,OAAO,CAAC,GAAG;YACtBC,WAAW,EAAE,CAAC;YACdC,UAAU,EAAE;UACd,CAAC;QACH,CAAC,CAAC;;QAEF;QACAC,MAAM,CAACC,OAAO,CAACb,QAAQ,CAACM,IAAI,CAAC,CAACE,OAAO,CAAC,CAAC,CAACC,OAAO,EAAEK,MAAM,CAAC,KAAK;UAC3D,MAAMC,KAAK,GAAGC,QAAQ,CAACF,MAAM,CAACG,UAAU,EAAE,EAAE,CAAC;UAC7C,MAAMC,cAAc,GAAGF,QAAQ,CAACF,MAAM,CAACK,aAAa,EAAE,EAAE,CAAC;UAEzD,IAAIZ,YAAY,CAACE,OAAO,CAAC,EAAE;YACzBF,YAAY,CAACE,OAAO,CAAC,CAACC,WAAW,GAAGK,KAAK;YACzCR,YAAY,CAACE,OAAO,CAAC,CAACE,UAAU,GAAGO,cAAc,GAAGH,KAAK;UAC3D;QACF,CAAC,CAAC;;QAEF;QACA,MAAMK,MAAM,GAAG,CAAC,CAAC;QACjBR,MAAM,CAACS,IAAI,CAACd,YAAY,CAAC,CAACC,OAAO,CAAEC,OAAO,IAAK;UAC7C,MAAMC,WAAW,GAAGH,YAAY,CAACE,OAAO,CAAC,CAACC,WAAW;UACrD,MAAMC,UAAU,GAAGJ,YAAY,CAACE,OAAO,CAAC,CAACE,UAAU;UAEnDS,MAAM,CAACX,OAAO,CAAC,GAAG;YAChBa,MAAM,EAAE,CAAC,iBAAiB,EAAE,oBAAoB,CAAC;YACjDC,QAAQ,EAAE,CACR;cACEC,KAAK,EAAEf,OAAO;cACdH,IAAI,EAAE,CAACI,WAAW,EAAEC,UAAU,CAAC;cAC/Bc,eAAe,EAAE,CACf,yBAAyB;cAAE;cAC3B,yBAAyB,CAAG;cAAA,CAC7B;cACDC,WAAW,EAAE;YACf,CAAC,CACF;YACDC,OAAO,EAAE;cACPC,UAAU,EAAE;gBACVC,OAAO,EAAGC,OAAO,IAAKA,OAAO,CAACC,SAAS,KAAK,CAAC;gBAAE;gBAC/CC,SAAS,EAAEA,CAACC,KAAK,EAAEH,OAAO,KAAK;kBAC7B,MAAMI,KAAK,GAAGJ,OAAO,CAACK,OAAO,CAAC7B,IAAI,CAAC8B,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAKD,GAAG,GAAGC,GAAG,EAAE,CAAC,CAAC;kBACrE,MAAMC,UAAU,GAAGL,KAAK,GAAG,CAAC,GAAG,CAAEJ,OAAO,CAACK,OAAO,CAAC7B,IAAI,CAAC,CAAC,CAAC,GAAG4B,KAAK,GAAI,GAAG,EAAEM,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI;kBAC1F,OAAOD,UAAU,KAAK,IAAI,GAAG,GAAGA,UAAU,GAAG,GAAG,gBAAgB;gBAClE,CAAC;gBACDE,KAAK,EAAE,OAAO;gBACdC,IAAI,EAAE;kBACJC,MAAM,EAAE,MAAM;kBACdC,IAAI,EAAE;gBACR;cACF;YACF;UACF,CAAC;QACH,CAAC,CAAC;QAEF,IAAIjD,SAAS,EAAE;UACbF,YAAY,CAAC2B,MAAM,CAAC;QACtB;MACF,CAAC,CAAC,OAAOyB,KAAK,EAAE;QACd,IAAIlD,SAAS,EAAE;UACbS,OAAO,CAACyC,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;QAC9C;MACF;IACF,CAAC;IAEDjD,SAAS,CAAC,CAAC;IAEX,OAAO,MAAM;MACXD,SAAS,GAAG,KAAK,CAAC,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,CAACD,WAAW,CAAC,CAAC,CAAC,CAAC;;EAEnB,oBACEN,OAAA;IAAA0D,QAAA,gBACE1D,OAAA,CAACF,MAAM;MAAA6D,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAC,CAAC,eACT9D,OAAA;MAAA0D,QAAA,EAAI;IAAsB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC/B9D,OAAA;MAAK+D,SAAS,EAAC,YAAY;MAAAL,QAAA,EACxBlC,MAAM,CAACS,IAAI,CAAC7B,SAAS,CAAC,CAAC4D,GAAG,CAAE3C,OAAO,iBAClCrB,OAAA;QAAmB+D,SAAS,EAAC,iBAAiB;QAAAL,QAAA,gBAC5C1D,OAAA;UAAA0D,QAAA,EAAKrC;QAAO;UAAAsC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eAClB9D,OAAA,CAACV,QAAQ;UACP4B,IAAI,EAAEd,SAAS,CAACiB,OAAO,CAAE;UACzB4C,OAAO,EAAE;YACPC,UAAU,EAAE,IAAI;YAChB3B,OAAO,EAAE;cACP4B,MAAM,EAAE;gBACNC,QAAQ,EAAE;cACZ,CAAC;cACDC,KAAK,EAAE;gBACL5B,OAAO,EAAE,IAAI;gBACb6B,IAAI,EAAE,kBAAkBjD,OAAO;cACjC,CAAC;cACDmB,UAAU,EAAE;gBACVC,OAAO,EAAGC,OAAO,IAAKA,OAAO,CAACC,SAAS,KAAK,CAAC;gBAAE;gBAC/CC,SAAS,EAAEA,CAACC,KAAK,EAAEH,OAAO,KAAK;kBAC7B,MAAMI,KAAK,GAAGJ,OAAO,CAACK,OAAO,CAAC7B,IAAI,CAAC8B,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAKD,GAAG,GAAGC,GAAG,EAAE,CAAC,CAAC;kBACrE,MAAMC,UAAU,GAAGL,KAAK,GAAG,CAAC,GAAG,CAAEJ,OAAO,CAACK,OAAO,CAAC7B,IAAI,CAAC,CAAC,CAAC,GAAG4B,KAAK,GAAI,GAAG,EAAEM,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI;kBAC1F,OAAOD,UAAU,KAAK,IAAI,GAAG,GAAGA,UAAU,GAAG,GAAG,gBAAgB;gBAClE,CAAC;gBACDE,KAAK,EAAE,OAAO;gBACdC,IAAI,EAAE;kBACJC,MAAM,EAAE,MAAM;kBACdC,IAAI,EAAE;gBACR;cACF;YACF;UACF;QAAE;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA,GA7BMzC,OAAO;QAAAsC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OA8BZ,CACN;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC,eACN9D,OAAA,CAACuE,MAAM;MAAAZ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACP,CAAC;AAEV,CAAC;AAAC3D,EAAA,CAvIID,gBAAgB;AAAAsE,EAAA,GAAhBtE,gBAAgB;AAyItB,eAAeA,gBAAgB;AAAC,IAAAsE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}